# Final System: Musl 1.1.22
# Source: https://www.musl-libc.org/releases/musl-1.1.22.tar.gz
# This section is done in Chroot environment

# Configure source
./configure --prefix=/usr -disable-gcc-wrapper

# Build and Install 
make && make install

# Create link for ldd
ln -sv /lib/ld-musl-i386.so.1 /bin/ldd

# Create config for dynamic library loading:
cat > /etc/ld-musl-i386.path << "EOF"
/lib
/usr/local/lib
/usr/lib
EOF

# Fake ldconfig
ln -s true /usr/bin/ldconfig

# If desired, install legacy compatability headers:
cp -v ../files/musl-legacy-compat-void/cdefs.h /usr/include/sys/
cp -v ../files/musl-legacy-compat-void/queue.h /usr/include/sys/
cp -v ../files/musl-legacy-compat-void/tree.h /usr/include/sys/
